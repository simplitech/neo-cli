using Microsoft.VisualStudio.TestTools.UnitTesting;
using Neo.Cli.Extensions;
using Neo;

namespace neo_cli_unit_tests
{
	[TestClass]
	public class CliTests
	{
		[TestMethod]
		public void TestDetectTransfer()
		{
			var hexScript = "040094357714cd67b97d5bd6205e75f8ffd82ce8530d1e5c87f2146f67e45d6acf463ae27e535650418739efea9da553c1087472616e73666572142582d1b275e86c8f0e93a9b2facd5fdb760976a168627d5b52f1";
			var byteScript = hexScript.HexToBytes();
			var strScript = CLIHelper.DisassembleScript(byteScript);
			Assert.IsNotNull(strScript);
			var transfers = CLIHelper.ExtractTransfersFromScript(strScript);
			Assert.IsTrue(transfers.Count == 1);
		}

		[TestMethod]
		public void TestDisassembleLongScript()
		{
			var longHexScript = "4dd1017b2267726f757073223a5b5d2c226665617475726573223a7b2273746f72616765223a66616c73652c2270" +
								"617961626c65223a66616c73657d2c22616269223a7b2268617368223a2230786436626262303633306264363336" +
								"3161306462363632666332353234323038666533393964633434222c22656e747279506f696e74223a7b226e616d" +
								"65223a224d61696e222c22706172616d6574657273223a5b7b226e616d65223a226f7065726174696f6e222c2274" +
								"797065223a22537472696e67227d2c7b226e616d65223a2261726773222c2274797065223a224172726179227d5d" +
								"2c2272657475726e54797065223a22427974654172726179227d2c226d6574686f6473223a5b7b226e616d65223a" +
								"224e616d65222c22706172616d6574657273223a5b5d2c2272657475726e54797065223a22537472696e67227d2c" +
								"7b226e616d65223a2253796d626f6c222c22706172616d6574657273223a5b5d2c2272657475726e54797065223a" +
								"22537472696e67227d5d2c226576656e7473223a5b5d7d2c227065726d697373696f6e73223a5b7b22636f6e7472" +
								"616374223a222a222c226d6574686f6473223a222a227d5d2c22747275737473223a5b5d2c22736166654d657468" +
								"6f6473223a5b5d7d4c9200c56b56c56b6c766b00527ac46c766b51527ac4616168e97d38a0609c6a52527ac46a52" +
								"c3644700616a00c3046e616d65876a53527ac46a53c3640f0061653e006a54527ac4622f006a00c30673796d626f" +
								"6c876a55527ac46a55c3640f00616527006a54527ac4620d0061006a54527ac46203006a54c3616c756600c56b03" +
								"5a5a48616c756600c56b035a5a48616c756668f66ca56e";

			var byteScript = longHexScript.HexToBytes();
			var strScript = CLIHelper.DisassembleScript(byteScript);
			Assert.IsNotNull(strScript);
		}
	}
}
